{
  "description": "sample Snowplow/sp_408_Normalized.json",
  "meta": {
    "full_size": 3876,
    "stripped_size": 3266,
    "features": [
      "@minmaxLength",
      "additionalProperties",
      "enum"
    ],
    "raw_features": [
      "_boolSchema",
      "maxLength",
      "properties",
      "required",
      "type",
      "type:object",
      "type:string"
    ]
  },
  "schema": {
    "additionalProperties": false,
    "description": "Schema for a context generated by the YAUAA enrichment after parsing the user agent",
    "properties": {
      "agentBuild": {
        "maxLength": 100,
        "type": "string"
      },
      "agentClass": {
        "description": "See https://yauaa.basjes.nl/README-Output.html",
        "enum": [
          "Browser",
          "Browser Webview",
          "Mobile App",
          "Robot",
          "Robot Mobile",
          "Cloud Application",
          "Email Client",
          "Voice",
          "Special",
          "Testclient",
          "Hacker",
          "Unknown"
        ]
      },
      "agentInformationEmail": {
        "_format": "email",
        "type": "string"
      },
      "agentInformationUrl": {
        "type": "string"
      },
      "agentLanguage": {
        "maxLength": 50,
        "type": "string"
      },
      "agentLanguageCode": {
        "maxLength": 20,
        "type": "string"
      },
      "agentName": {
        "description": "Example: Chrome.",
        "maxLength": 100,
        "type": "string"
      },
      "agentNameVersion": {
        "maxLength": 200,
        "type": "string"
      },
      "agentNameVersionMajor": {
        "maxLength": 120,
        "type": "string"
      },
      "agentSecurity": {
        "enum": [
          "Weak security",
          "Strong security",
          "Unknown",
          "Hacker"
        ],
        "type": "string"
      },
      "agentUuid": {
        "type": "string"
      },
      "agentVersion": {
        "maxLength": 100,
        "type": "string"
      },
      "agentVersionMajor": {
        "maxLength": 20,
        "type": "string"
      },
      "anonymized": {
        "type": "string"
      },
      "carrier": {
        "type": "string"
      },
      "deviceBrand": {
        "description": "Example: Google",
        "maxLength": 50,
        "type": "string"
      },
      "deviceClass": {
        "description": "See https://yauaa.basjes.nl/README-Output.html",
        "enum": [
          "Desktop",
          "Anonymized",
          "Unknown",
          "UNKNOWN",
          "Mobile",
          "Tablet",
          "Phone",
          "Watch",
          "Virtual Reality",
          "eReader",
          "Set-top box",
          "TV",
          "Game Console",
          "Handheld Game Console",
          "Voice",
          "Robot",
          "Robot Mobile",
          "Spy",
          "Hacker"
        ]
      },
      "deviceCpu": {
        "maxLength": 50,
        "type": "string"
      },
      "deviceCpuBits": {
        "maxLength": 20,
        "type": "string"
      },
      "deviceFirmwareVersion": {
        "maxLength": 100,
        "type": "string"
      },
      "deviceName": {
        "description": "Example: Google Nexus 6",
        "maxLength": 100,
        "type": "string"
      },
      "deviceVersion": {
        "maxLength": 100,
        "type": "string"
      },
      "facebookCarrier": {
        "type": "string"
      },
      "facebookDeviceClass": {
        "maxLength": 1024,
        "type": "string"
      },
      "facebookDeviceName": {
        "maxLength": 1024,
        "type": "string"
      },
      "facebookDeviceVersion": {
        "type": "string"
      },
      "facebookFBOP": {
        "type": "string"
      },
      "facebookFBSS": {
        "type": "string"
      },
      "facebookOperatingSystemName": {
        "type": "string"
      },
      "facebookOperatingSystemVersion": {
        "type": "string"
      },
      "gSAInstallationID": {
        "type": "string"
      },
      "hackerAttackVector": {
        "type": "string"
      },
      "hackerToolkit": {
        "type": "string"
      },
      "iECompatibilityNameVersion": {
        "maxLength": 50,
        "type": "string"
      },
      "iECompatibilityNameVersionMajor": {
        "maxLength": 70,
        "type": "string"
      },
      "iECompatibilityVersion": {
        "maxLength": 100,
        "type": "string"
      },
      "iECompatibilityVersionMajor": {
        "maxLength": 50,
        "type": "string"
      },
      "koboAffiliate": {
        "type": "string"
      },
      "koboPlatformId": {
        "type": "string"
      },
      "layoutEngineBuild": {
        "maxLength": 100,
        "type": "string"
      },
      "layoutEngineClass": {
        "description": "See https://yauaa.basjes.nl/README-Output.html",
        "enum": [
          "Browser",
          "Mobile App",
          "Hacker",
          "Robot",
          "Unknown"
        ]
      },
      "layoutEngineName": {
        "maxLength": 100,
        "type": "string"
      },
      "layoutEngineNameVersion": {
        "maxLength": 150,
        "type": "string"
      },
      "layoutEngineNameVersionMajor": {
        "maxLength": 120,
        "type": "string"
      },
      "layoutEngineVersion": {
        "maxLength": 50,
        "type": "string"
      },
      "layoutEngineVersionMajor": {
        "maxLength": 20,
        "type": "string"
      },
      "networkType": {
        "type": "string"
      },
      "operatingSystemClass": {
        "description": "See https://yauaa.basjes.nl/README-Output.html",
        "enum": [
          "Desktop",
          "Mobile",
          "Cloud",
          "Embedded",
          "Game Console",
          "Hacker",
          "Anonymized",
          "Unknown"
        ]
      },
      "operatingSystemName": {
        "description": "Examples: Linux, Android.",
        "maxLength": 100,
        "type": "string"
      },
      "operatingSystemNameVersion": {
        "maxLength": 150,
        "type": "string"
      },
      "operatingSystemVersion": {
        "maxLength": 50,
        "type": "string"
      },
      "operatingSystemVersionBuild": {
        "maxLength": 100,
        "type": "string"
      },
      "webviewAppName": {
        "type": "string"
      },
      "webviewAppNameVersionMajor": {
        "maxLength": 50,
        "type": "string"
      },
      "webviewAppVersion": {
        "type": "string"
      },
      "webviewAppVersionMajor": {
        "maxLength": 50,
        "type": "string"
      }
    },
    "required": [
      "deviceClass"
    ],
    "self": {
      "format": "jsonschema",
      "name": "yauaa_context",
      "vendor": "nl.basjes",
      "version": "1-0-0"
    },
    "type": "object"
  },
  "tests": [
    {
      "description": "llama 70b generated valid",
      "valid": true,
      "data": {
        "agentBuild": "12345",
        "agentClass": "Browser",
        "agentInformationEmail": "test@example.com",
        "agentInformationUrl": "https://example.com",
        "agentLanguage": "English",
        "agentLanguageCode": "en",
        "agentName": "Chrome",
        "agentNameVersion": "Chrome 103",
        "agentNameVersionMajor": "Chrome 103",
        "agentSecurity": "Strong security",
        "agentUuid": "123e4567-e89b-12d3-a456-426614174000",
        "agentVersion": "103.0.5060.134",
        "agentVersionMajor": "103",
        "anonymized": "false",
        "carrier": "Verizon",
        "deviceBrand": "Google",
        "deviceClass": "Desktop",
        "deviceCpu": "x86",
        "deviceCpuBits": "64",
        "deviceFirmwareVersion": "1.0",
        "deviceName": "Google Nexus 6",
        "deviceVersion": "1.0",
        "facebookCarrier": "Verizon",
        "facebookDeviceClass": "Desktop",
        "facebookDeviceName": "Google Nexus 6",
        "facebookDeviceVersion": "1.0",
        "facebookFBOP": "false",
        "facebookFBSS": "false",
        "facebookOperatingSystemName": "Windows",
        "facebookOperatingSystemVersion": "10",
        "gSAInstallationID": "123e4567-e89b-12d3-a456-426614174000",
        "hackerAttackVector": "none",
        "hackerToolkit": "none",
        "iECompatibilityNameVersion": "11.0",
        "iECompatibilityNameVersionMajor": "11",
        "iECompatibilityVersion": "11.0",
        "iECompatibilityVersionMajor": "11",
        "koboAffiliate": "none",
        "koboPlatformId": "none",
        "layoutEngineBuild": "12345",
        "layoutEngineClass": "Browser",
        "layoutEngineName": "Blink",
        "layoutEngineNameVersion": "Blink 103",
        "layoutEngineNameVersionMajor": "Blink 103",
        "layoutEngineVersion": "103.0.5060.134",
        "layoutEngineVersionMajor": "103",
        "networkType": "wired",
        "operatingSystemClass": "Desktop",
        "operatingSystemName": "Windows",
        "operatingSystemNameVersion": "Windows 10",
        "operatingSystemVersion": "10",
        "operatingSystemVersionBuild": "19042",
        "webviewAppName": "none",
        "webviewAppNameVersionMajor": "none",
        "webviewAppVersion": "none",
        "webviewAppVersionMajor": "none"
      }
    },
    {
      "description": "llama-70b generated negative",
      "valid": false,
      "rust_error": "Additional properties are not allowed ('extraProperty' was unexpected)",
      "python_error": "Additional properties are not allowed ('extraProperty' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'description': 'Schema for a context generated by the YAUAA '\n                    'enrichment after parsing the user agent',\n     'properties': {'agentBuild': {'maxLength': 100, 'type': 'string'},\n                    'agentClass': {'description': 'See '\n                                                  'https://yauaa.basjes.nl/README-Output.html',\n                                   'enum': ['Browser',\n                                            'Browser Webview',\n                                            'Mobile App',\n                                            'Robot',\n                                            'Robot Mobile',\n                                            'Cloud Application',\n                                            'Email Client',\n                                            'Voice',\n                                          .. (10599 more)",
      "data": {
        "agentBuild": "12345",
        "agentClass": "Browser",
        "agentInformationEmail": "test@example.com",
        "agentInformationUrl": "https://example.com",
        "agentLanguage": "English",
        "agentLanguageCode": "en",
        "agentName": "Chrome",
        "agentNameVersion": "Chrome 103",
        "agentNameVersionMajor": "Chrome 103",
        "agentSecurity": "Strong security",
        "agentUuid": "123e4567-e89b-12d3-a456-426614174000",
        "agentVersion": "103.0.5060.134",
        "agentVersionMajor": "103",
        "anonymized": "false",
        "carrier": "Verizon",
        "deviceBrand": "Google",
        "deviceClass": "Desktop",
        "deviceCpu": "x86",
        "deviceCpuBits": "64",
        "deviceFirmwareVersion": "1.0",
        "deviceName": "Google Nexus 6",
        "deviceVersion": "1.0",
        "facebookCarrier": "Verizon",
        "facebookDeviceClass": "Desktop",
        "facebookDeviceName": "Google Nexus 6",
        "facebookDeviceVersion": "1.0",
        "facebookFBOP": "false",
        "facebookFBSS": "false",
        "facebookOperatingSystemName": "Windows",
        "facebookOperatingSystemVersion": "10",
        "gSAInstallationID": "123e4567-e89b-12d3-a456-426614174000",
        "hackerAttackVector": "none",
        "hackerToolkit": "none",
        "iECompatibilityNameVersion": "11.0",
        "iECompatibilityNameVersionMajor": "11",
        "iECompatibilityVersion": "11.0",
        "iECompatibilityVersionMajor": "11",
        "koboAffiliate": "none",
        "koboPlatformId": "none",
        "layoutEngineBuild": "12345",
        "layoutEngineClass": "Browser",
        "layoutEngineName": "Blink",
        "layoutEngineNameVersion": "Blink 103",
        "layoutEngineNameVersionMajor": "Blink 103",
        "layoutEngineVersion": "103.0.5060.134",
        "layoutEngineVersionMajor": "103",
        "networkType": "wired",
        "operatingSystemClass": "Desktop",
        "operatingSystemName": "Windows",
        "operatingSystemNameVersion": "Windows 10",
        "operatingSystemVersion": "10",
        "operatingSystemVersionBuild": "19042",
        "webviewAppName": "none",
        "webviewAppNameVersionMajor": "none",
        "webviewAppVersion": "none",
        "webviewAppVersionMajor": "none",
        "extraProperty": "extraValue"
      }
    },
    {
      "description": "llama 70b generated positive",
      "valid": true,
      "data": {
        "agentBuild": "12345",
        "agentClass": "Browser",
        "agentInformationEmail": "support@example.com",
        "agentInformationUrl": "https://example.com",
        "agentLanguage": "English",
        "agentLanguageCode": "en-US",
        "agentName": "Chrome",
        "agentNameVersion": "Chrome 107.0.5304.110",
        "agentNameVersionMajor": "Chrome 107",
        "agentSecurity": "Strong security",
        "agentUuid": "1234567890",
        "agentVersion": "107.0.5304.110",
        "agentVersionMajor": "107",
        "anonymized": "false",
        "carrier": "Verizon",
        "deviceBrand": "Google",
        "deviceClass": "Desktop",
        "deviceCpu": "x86_64",
        "deviceCpuBits": "64",
        "deviceFirmwareVersion": "1.0",
        "deviceName": "Google Nexus 6",
        "deviceVersion": "1.0",
        "facebookCarrier": "Verizon",
        "facebookDeviceClass": "Desktop",
        "facebookDeviceName": "Google Nexus 6",
        "facebookDeviceVersion": "1.0",
        "facebookFBOP": "false",
        "facebookFBSS": "false",
        "facebookOperatingSystemName": "Windows",
        "facebookOperatingSystemVersion": "10",
        "gSAInstallationID": "1234567890",
        "hackerAttackVector": "",
        "hackerToolkit": "",
        "iECompatibilityNameVersion": "11.0",
        "iECompatibilityNameVersionMajor": "11",
        "iECompatibilityVersion": "11.0",
        "iECompatibilityVersionMajor": "11",
        "koboAffiliate": "",
        "koboPlatformId": "",
        "layoutEngineBuild": "12345",
        "layoutEngineClass": "Browser",
        "layoutEngineName": "Blink",
        "layoutEngineNameVersion": "Blink 107.0.5304.110",
        "layoutEngineNameVersionMajor": "Blink 107",
        "layoutEngineVersion": "107.0.5304.110",
        "layoutEngineVersionMajor": "107",
        "networkType": "Wired",
        "operatingSystemClass": "Desktop",
        "operatingSystemName": "Windows",
        "operatingSystemNameVersion": "Windows 10",
        "operatingSystemVersion": "10",
        "operatingSystemVersionBuild": "19042",
        "webviewAppName": "",
        "webviewAppNameVersionMajor": "",
        "webviewAppVersion": "",
        "webviewAppVersionMajor": ""
      }
    },
    {
      "description": "llama-70b generated negative",
      "valid": false,
      "rust_error": "Additional properties are not allowed ('ExtraProperty' was unexpected)",
      "python_error": "Additional properties are not allowed ('ExtraProperty' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'description': 'Schema for a context generated by the YAUAA '\n                    'enrichment after parsing the user agent',\n     'properties': {'agentBuild': {'maxLength': 100, 'type': 'string'},\n                    'agentClass': {'description': 'See '\n                                                  'https://yauaa.basjes.nl/README-Output.html',\n                                   'enum': ['Browser',\n                                            'Browser Webview',\n                                            'Mobile App',\n                                            'Robot',\n                                            'Robot Mobile',\n                                            'Cloud Application',\n                                            'Email Client',\n                                            'Voice',\n                                          .. (10558 more)",
      "data": {
        "agentBuild": "12345",
        "agentClass": "Browser",
        "agentInformationEmail": "support@example.com",
        "agentInformationUrl": "https://example.com",
        "agentLanguage": "English",
        "agentLanguageCode": "en-US",
        "agentName": "Chrome",
        "agentNameVersion": "Chrome 107.0.5304.110",
        "agentNameVersionMajor": "Chrome 107",
        "agentSecurity": "Strong security",
        "agentUuid": "1234567890",
        "agentVersion": "107.0.5304.110",
        "agentVersionMajor": "107",
        "anonymized": "false",
        "carrier": "Verizon",
        "deviceBrand": "Google",
        "deviceClass": "Desktop",
        "deviceCpu": "x86_64",
        "deviceCpuBits": "64",
        "deviceFirmwareVersion": "1.0",
        "deviceName": "Google Nexus 6",
        "deviceVersion": "1.0",
        "facebookCarrier": "Verizon",
        "facebookDeviceClass": "Desktop",
        "facebookDeviceName": "Google Nexus 6",
        "facebookDeviceVersion": "1.0",
        "facebookFBOP": "false",
        "facebookFBSS": "false",
        "facebookOperatingSystemName": "Windows",
        "facebookOperatingSystemVersion": "10",
        "gSAInstallationID": "1234567890",
        "hackerAttackVector": "",
        "hackerToolkit": "",
        "iECompatibilityNameVersion": "12345678901",
        "iECompatibilityNameVersionMajor": "1234567890",
        "iECompatibilityVersion": "11.0",
        "iECompatibilityVersionMajor": "11",
        "koboAffiliate": "",
        "koboPlatformId": "",
        "layoutEngineBuild": "12345",
        "layoutEngineClass": "Browser",
        "layoutEngineName": "Blink",
        "layoutEngineNameVersion": "Blink 107.0.5304.110",
        "layoutEngineNameVersionMajor": "Blink 107",
        "layoutEngineVersion": "107.0.5304.110",
        "layoutEngineVersionMajor": "107",
        "networkType": "Wired",
        "operatingSystemClass": "Desktop",
        "operatingSystemName": "Windows",
        "operatingSystemNameVersion": "Windows 10",
        "operatingSystemVersion": "10",
        "operatingSystemVersionBuild": "19042",
        "webviewAppName": "",
        "webviewAppNameVersionMajor": "",
        "webviewAppVersion": "",
        "webviewAppVersionMajor": "",
        "ExtraProperty": "Invalid"
      }
    }
  ]
}